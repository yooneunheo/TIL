## SECTION 14 - 04. 스택의 응용 - 후위표기식 (4)

##### p. 49

-예시가 잘못 되었다. 따라서 p. 32에 있는 예시로 다시 설명하겠다.

<b>3 + ((4 \* 7) / 2)</b>

- 3은 피연산자이므로 출력
- +는 연산자이므로 스택에 들어간다
- 여는 괄호는 무조건 스택에 들어간다. 두개 연속으로 넣는다
- 4는 피연산자이므로 출력한다
- *를 넣으려는데 스택 안에 여는 괄호가 있으면 아무도 pop되지 못하므로 *을 바로 push한다.
- 다음에 7 출력
- 이제 닫는 괄호가 나오므로 여는 괄호가 나올 때까지 stack을 비운다. 따라서 \*와 여는 괄호 하나가 나오고 괄호들은 자기 역할을 다 했으므로 사라진다.
- 3 4 7 \* 까지 출력
- 그리고 다시 /를 스택에 넣을 건데, 여는 괄호가 있으므로 아무도 못 나오고 /는 바로 push된다.
- 2는 피연산자이므로 출력
- 닫는 괄호가 나왔으므로 여는 괄호까지 모두 pop 한다.
- 3 4 7 \* 2 / 까지 출력되고 수식이 종료. 스택에 남아있는 +까지 출력.
- 최종적으로, 3 4 7 \* 2 / + 로 변환

<br>

##### p. 50

괄호가 없는 경우와 코드가 크게 다르지는 않다. process_op 부분만 약간 수정하면 된다.

원래는 스택에 있는 것과 현재 추가하려는 연산자의 우선순위를 비교하는 과정을 거쳐야하지만, 여는 괄호가 있다면 무조건 pop은 안 되고 push만 된다. 이걸 추후 코드로 어떻게 표현할 지 살펴보도록 하겠다.

<br>

##### p. 51

- create(100) 은 오타, create()여야 한다.

<br>

##### p. 52

- else 문에서 2번 규칙을 무시한다는 말은 다음과 같다. else문에 도달했다는 말은 현재 추가하려는 연산자인 op가 '(' 가 아니라는 소리이다. 만약 '('라면 if문으로 갔을 테니까. 즉, +-\*/) 중에 하나란 소리이다. 만약 top_op가 여는 괄호일 경우 precedence 값이 -1이라서 무조건 현재 넣을 연산자인 precedence(op)값보다 작다. 따라서 push(operator_stack, op) 가 된다.
- else문의 하위 else문에서 top_op가 여는 괄호라면 op의 우선순위가 top_op보다 작거나 같다는 말인데, 즉 op가 닫는 괄호라는 말이다. 닫는 괄호는 여는 괄호를 만날 때까지 pop을 한다. 그러다 여는 괄호를 만나면 다 끝난 것이므로 break;로 while문을 빠져나와야 한다. 물론 닫는 괄호는 스택에 넣지 않으므로 if 문도 건너뛴다.
- 만약 닫는 괄호가 아니라면 스택에서 꺼낸 top_op를 출력하고, 스택이 비어있지 않으면 다시 top_op를 peek해서 while문을 더 돈다.

<br>

##### p. 51

- 선으로 그은 부분까지 후위표기식으로 변환이 완료된 부분이다. 하지만 스택에 남아있는 게 있을 수 있으니 while문에서 비워주는 처리를 한다.
- 원래라면 스택에 여는 괄호가 있어선 안된다. 하지만 있다는 말은 infix 수식 자체가 잘못되었다는 말이다. 따라서 에러 메시지를 출력하고 종료
- 만약 그렇지 않고 정상적이라면 스택에 있는 걸 모두 출력하고 맨 마지막에 널을 추가해서 리턴하고 종료.

<br>

##### p. 53

- 지금까지 작성한 프로그램을 간단히 테스트 하는 main 함수이다.
- read_line으로 infix를 입력으로 받는다
- read_line으로 받은 걸 printf로 출력한다
- infix를 postix로 변환해서 eval, 즉 계산한 다음에 출력한다.

<br>

##### p. 54

- 후위표기식 변환과 계산을 같이 하는 법?

2 \* (3 + 4 \* 2) / 2

- 스택을 두 개 만들어서 하나는 연산자, 다른 하나는 피연산자를 넣는다.
- 스택을 순서대로 쌓는다. 이때 연산자에서 닫는 괄호가 나오면, 여는 괄호가 나올 때까지 pop해야 되므로
- 우선 \*이 나온다. 그러면 피연산자 스택에서 상위 두 개를 꺼내서 계산한 다음 2\*4 = 8을 다시 스택에 넣는다.
- 그리고 다시 +가 출력되면 피연산자 스택에서 두 개를 꺼내 계산해서 스택에 넣는다.
- 이렇게 여는 괄호가 나올 때까지 하고, 여는 괄호가 나오면 괄호들은 사라진다.
- 이제 남은 연산자 \*이 나오고 피연산자 스택에서 남은 두 개를 꺼내서 계산한 다음 push한다.
- 마지막으로 /를 스택에 넣은 다음 남은 피연산자들 두 개를 계산해서 push한다.
